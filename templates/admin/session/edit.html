{extends file='admin.tpl'}

{block name=main}
<div class="page-header">
	<h1>Parallel Sessions <small>{$session['title']|escape}</small></h1>
</div>
<ol class="breadcrumb">
	<li><a href="{$smarty.const.TOP}/admin/index.php?token={$token}">管理後台</a></li>
	<li><a href="{$smarty.const.TOP}/admin/sessions.php?token={$token}">Parallel Sessions</a></li>
	<li class="active">編輯</li>
</ol>
<form action="{$smarty.const.TOP}/admin/session/edit_title.php?token={$token}" method="POST">
	<div class="row">
		<div class="col-xs-2"><label>Title</label></div>
		<div class="col-xs-8">
			<input type="hidden" name="session_id" value="{$session['id']}">
			<input class="form-control" type="text" name="value" value="{$session['title']|escape}">
		</div>
		<div class="col-xs-2">
			<button type="submit" class="btn btn-default">更新</button>
		</div>
	</div>
</form>
<form action="{$smarty.const.TOP}/admin/session/edit_location.php?token={$token}" method="POST">
	<div class="row">
		<div class="col-xs-2"><label>Location</label></div>
		<div class="col-xs-8">
			<input type="hidden" name="session_id" value="{$session['id']}">
			<input class="form-control" type="text" name="value" value="{$session['location']|escape}">
		</div>
		<div class="col-xs-2">
			<button type="submit" class="btn btn-default">更新</button>
		</div>
	</div>
</form>
<form action="{$smarty.const.TOP}/admin/session/edit_datetime.php?token={$token}" method="POST">
	<div class="row">
		<div class="col-xs-2"><label>Date &amp; time</label></div>
		<div class="col-xs-2">
			<input type="hidden" name="session_id" value="{$session['id']}">
			<input class="form-control" type="text" name="date" value="{$session['date']|escape}" placeholder="0000/00/00">
		</div>
		<div class="col-xs-2">
			<input class="form-control" type="text" name="time" value="{$session['time']|escape}" placeholder="00:00">
		</div>
		<div class="col-xs-2">
			<button type="submit" class="btn btn-default">更新</button>
		</div>
	</div>
</form>
<h2>Organizers</h2>
<table class="table">
	<thead>
		<tr><th>Name</th><th></th><th></th></tr>
	</thead>
	<tbody>
		{foreach $session['organizers'] as $organizer}
		<tr>
			<td>{$organizer['content']['first_name']} {$organizer['content']['last_name']}</td>
			<td><a href="{$smarty.const.TOP}/admin/person/edit.php?token={$token}&id={$organizer['content']['id']}" class="btn btn-default">編輯</a></td>
			<td>
				<form method="POST" action="{$smarty.const.TOP}/admin/session/delete.php?token={$token}">
					<input type="hidden" name="id" value="{$organizer['id']}" />
					<input type="hidden" name="session_id" value="{$organizer['session_id']}" />
					<button class="btn btn-danger" onClick="return confirm('確定刪除？');">刪除</button>
				</form>
			</td>
		</tr>
		{/foreach}
		<tr>
			<form action="{$smarty.const.TOP}/admin/session/insert.php?token={$token}" method="POST">
				<td>
					<label>選擇一個Parallel Session的人</label>
					<input type="hidden" name="session_id" value="{$session['id']}">
					<input type="hidden" name="name" value="organizer">
					<select class="form-control" name="value" required>
						<option value=""></option>
						{foreach $people as $person}
						<option value="{$person['id']}">{$person['first_name']} {$person['last_name']}</option>
						{/foreach}
					</select>
				</td>
				<td><button type="submit" class="btn btn-default">新增</button></td>
				<td></td>
			</form>
		</tr>
	</tbody>
</table>
<h2>Speakers</h2>
<table class="table">
	<thead>
		<tr><th>Name</th><th></th><th></th></tr>
	</thead>
	<tbody>
		{foreach $session['speakers'] as $speaker}
		<tr>
			<td>{$speaker['content']['first_name']} {$speaker['content']['last_name']}</td>
			<td><a href="{$smarty.const.TOP}/admin/person/edit.php?token={$token}&id={$speaker['content']['id']}" class="btn btn-default">編輯</a></td>
			<td>
				<form method="POST" action="{$smarty.const.TOP}/admin/session/delete_speaker.php?token={$token}">
					<input type="hidden" name="id" value="{$speaker['id']}" />
					<input type="hidden" name="person_id" value="{$speaker['content']['id']}" />
					<input type="hidden" name="session_id" value="{$speaker['session_id']}" />
					<button class="btn btn-danger" onClick="return confirm('確定刪除？');">刪除</button>
				</form>
			</td>
		</tr>
		{/foreach}
		<tr>
			<form action="{$smarty.const.TOP}/admin/session/insert_speaker.php?token={$token}" method="POST">
				<td>
					<label>選擇一個Parallel Session的人</label>
					<input type="hidden" name="session_id" value="{$session['id']}">
					<select class="form-control" name="value" required>
						<option value=""></option>
						{foreach $people as $person}
						<option value="{$person['id']}">{$person['first_name']} {$person['last_name']}</option>
						{/foreach}
					</select>
				</td>
				<td><button type="submit" class="btn btn-default">新增</button></td>
				<td></td>
			</form>
		</tr>
	</tbody>
</table>

{/block}
